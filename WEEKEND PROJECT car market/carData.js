const carMarket = {
    sellers: [
        {
            agencyName: "Best Deal",
            cash: 1245000,
            credit: 200000,
            agencyId: "Plyq5M5AZ",

            cars: [
                {
                    brand: "bmw",
                    models: [
                        {
                            name: "3",
                            year: 2015,
                            price: 137000,
                            carNumber: "AZJZ4",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "X6",
                            year: 2020,
                            price: 966500,
                            carNumber: "S6DL1",
                            ownerId: "Plyq5M5AZ",
                        },
                    ],
                },
                {
                    brand: "toyota",
                    models: [
                        {
                            name: "Land Cruiser",
                            year: 2020,
                            price: 336300,
                            carNumber: "6rvXw",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Hilux",
                            year: 2005,
                            price: 35005,
                            carNumber: "MWXBG",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Corolla",
                            year: 2020,
                            price: 111900,
                            carNumber: "hCzl-",
                            ownerId: "Plyq5M5AZ",
                        },
                    ],
                },
                {
                    brand: "Ford",
                    models: [
                        {
                            name: "Focus",
                            year: 2020,
                            price: 98200,
                            carNumber: "kN3HP",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Focus",
                            year: 2005,
                            price: 6502,
                            carNumber: "LJTCs",
                            ownerId: "Plyq5M5AZ",
                        },
                    ],
                },
                {
                    brand: "Alpha romeo",
                    models: [
                        {
                            name: "Romeo Julia",
                            year: 2020,
                            price: 275406,
                            carNumber: "2kjy7",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Romeo Stelvio",
                            year: 2019,
                            price: 215403,
                            carNumber: "7A5b-",
                            ownerId: "Plyq5M5AZ",
                        },
                    ],
                },
                {
                    brand: "Chevrolet",
                    models: [
                        {
                            name: "Traverse",
                            year: 2020,
                            price: 201102,
                            carNumber: "QwBOT",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Impala",
                            year: 2019,
                            price: 165041,
                            carNumber: "2v4jt",
                            ownerId: "Plyq5M5AZ",
                        },
                        {
                            name: "Malibu",
                            year: 2017,
                            price: 75405,
                            carNumber: "O4_Jv",
                            ownerId: "Plyq5M5AZ",
                        },
                    ],
                },
            ],
        },
        {
            agencyName: "CarMax",
            cash: 968541,
            credit: 500000,
            agencyId: "26_IPfHU1",
            cars: [
                {
                    brand: "bmw",
                    models: [
                        {
                            name: "X5",
                            year: 2015,
                            price: 218000,
                            carNumber: "4Ixb0",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "X6",
                            year: 2014,
                            price: 97100,
                            carNumber: "kAnv-",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "Z4",
                            year: 2019,
                            price: 296900,
                            carNumber: "ISMdU",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "3",
                            year: 2010,
                            price: 75100,
                            carNumber: "9DJPw",
                            ownerId: "26_IPfHU1",
                        },
                    ],
                },
                {
                    brand: "toyota",
                    models: [
                        {
                            name: "Land Cruiser",
                            year: 2005,
                            price: 80540,
                            carNumber: "Kt-pW",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "Corolla",
                            year: 2019,
                            price: 109100,
                            carNumber: "YiYdI",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "Hilux",
                            year: 2019,
                            price: 204000,
                            carNumber: "DRmNw",
                            ownerId: "26_IPfHU1",
                        },
                    ],
                },
                {
                    brand: "Ford",
                    models: [
                        {
                            name: "F250",
                            year: 2020,
                            price: 198500,
                            carNumber: "g4Wfp",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "Explorer",
                            year: 2020,
                            price: 265200,
                            carNumber: "iNT8Q",
                            ownerId: "26_IPfHU1",
                        },
                    ],
                },
                {
                    brand: "Alpha romeo",
                    models: [
                        {
                            name: "Spider",
                            year: 2011,
                            price: 75405,
                            carNumber: "6t7QU",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "166",
                            year: 2002,
                            price: 12400,
                            carNumber: "XMqpn",
                            ownerId: "26_IPfHU1",
                        },
                    ],
                },
                {
                    brand: "Chevrolet",
                    models: [
                        {
                            name: "Impala",
                            year: 2016,
                            price: 65042,
                            carNumber: "vbeAo",
                            ownerId: "26_IPfHU1",
                        },
                        {
                            name: "Savannah",
                            year: 2016,
                            price: 76505,
                            carNumber: "WelWa",
                            ownerId: "26_IPfHU1",
                        },
                    ],
                },
            ],
        },
        {
            agencyName: "The Auto World",
            cash: 687450,
            credit: 200000,
            agencyId: "gNHjNFL12",
            cars: [
                {
                    brand: "bmw",
                    models: [
                        {
                            name: "X6",
                            year: 2018,
                            price: 548100,
                            carNumber: "EMW_7",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "3",
                            year: 2017,
                            price: 178000,
                            carNumber: "XlnB4",
                            ownerId: "gNHjNFL12",
                        },
                    ],
                },
                {
                    brand: "toyota",
                    models: [
                        {
                            name: "Prius",
                            year: 2017,
                            price: 101542,
                            carNumber: "-RQgN",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "Highlander",
                            year: 2017,
                            price: 202540,
                            carNumber: "AZJZ4",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "Corolla",
                            year: 1996,
                            price: 5420,
                            carNumber: "kHE8f",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "Corolla",
                            year: 2012,
                            price: 40570,
                            carNumber: "p2qEi",
                            ownerId: "gNHjNFL12",
                        },
                    ],
                },
                {
                    brand: "Ford",
                    models: [
                        {
                            name: "Explorer",
                            year: 2014,
                            price: 127502,
                            carNumber: "Ty1zN",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "F350",
                            year: 2012,
                            price: 54250,
                            carNumber: "z03H2",
                            ownerId: "gNHjNFL12",
                        },
                    ],
                },
                {
                    brand: "Chevrolet",
                    models: [
                        {
                            name: "Savannah",
                            year: 2010,
                            price: 36504,
                            carNumber: "RXFZe",
                            ownerId: "gNHjNFL12",
                        },
                        {
                            name: "Malibu",
                            year: 2009,
                            price: 19585,
                            carNumber: "K5IsM",
                            ownerId: "gNHjNFL12",
                        },
                    ],
                },
            ],
        },
        {
            agencyName: "Car Werks",
            cash: 302502,
            credit: 150000,
            agencyId: "9KeaYbRLP",
            cars: [
                {
                    brand: "bmw",
                    models: [
                        {
                            name: "8",
                            year: 2020,
                            price: 942500,
                            carNumber: "4IUMz",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "X6",
                            year: 2010,
                            price: 129000,
                            carNumber: "Vw0fV",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "X3",
                            year: 2019,
                            price: 358100,
                            carNumber: "ufN54",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "3",
                            year: 2020,
                            price: 389100,
                            carNumber: "F127X",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "3",
                            year: 2002,
                            price: 18400,
                            carNumber: "ueZUp",
                            ownerId: "9KeaYbRLP",
                        },
                    ],
                },
                {
                    brand: "toyota",
                    models: [
                        {
                            name: "Prius",
                            year: 2011,
                            price: 38520,
                            carNumber: "AZJZ4",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "Land Cruiser",
                            year: 2019,
                            price: 290040,
                            carNumber: "AZJZ4",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "Hilux",
                            year: 2020,
                            price: 215700,
                            carNumber: "xig8N",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "Hilux",
                            year: 2015,
                            price: 178506,
                            carNumber: "ghTiQ",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "Corolla",
                            year: 2002,
                            price: 8504,
                            carNumber: "Mvw8T",
                            ownerId: "9KeaYbRLP",
                        },
                    ],
                },
                {
                    brand: "Chevrolet",
                    models: [
                        {
                            name: "Impala",
                            year: 2005,
                            price: 9320,
                            carNumber: "BZpkt",
                            ownerId: "9KeaYbRLP",
                        },
                        {
                            name: "Malibu",
                            year: 2002,
                            price: 4502,
                            carNumber: "KqKV_",
                            ownerId: "9KeaYbRLP",
                        },
                    ],
                },
            ],
        },
        {
            agencyName: "Carsova",
            cash: 72450,
            credit: 50000,
            agencyId: "oqQmsZoUo",
            cars: [
                {
                    brand: "bmw",
                    models: [
                        {
                            name: "7",
                            year: 1999,
                            price: 24700,
                            carNumber: "sZrjp",
                            ownerId: "oqQmsZoUo",
                        },
                        {
                            name: "3",
                            year: 2008,
                            price: 54000,
                            carNumber: "da88K",
                            ownerId: "oqQmsZoUo",
                        },
                    ],
                },
                {
                    brand: "toyota",
                    models: [
                        {
                            name: "Prius",
                            year: 2019,
                            price: 124050,
                            carNumber: "ZfbqH",
                            ownerId: "oqQmsZoUo",
                        },
                        {
                            name: "Hilux",
                            year: 1996,
                            price: 11540,
                            carNumber: "AZJZ4",
                            ownerId: "oqQmsZoUo",
                        },
                    ],
                },
            ],
        },
    ],
    customers: [
        {
            name: "Lilah Goulding",
            id: "BGzHhjnE8",
            cars: [
                {
                    name: "Corolla",
                    year: 2013,
                    price: 40570,
                    carNumber: "16da1",
                    ownerId: "BGzHhjnE8",
                },
            ],
            cash: 35000,
        },
        {
            name: "Ravi Murillo",
            id: "2RprZ1dbL",
            cars: [
                {
                    name: "M5",
                    year: 2019,
                    price: 578054,
                    carNumber: "WIh0U",
                    ownerId: "2RprZ1dbL",
                },
                {
                    name: "Spider",
                    year: 2012,
                    price: 81520,
                    carNumber: "RLS4q",
                    ownerId: "2RprZ1dbL",
                },
            ],
            cash: 278542,
        },
        {
            name: "Aleksander Carr",
            id: "pAuFtn_WA",
            cars: [
                {
                    name: "Highlander",
                    year: 2018,
                    price: 214503,
                    carNumber: "2WU_y",
                    ownerId: "pAuFtn_WA",
                },
            ],
            cash: 125402,
        },
        {
            name: "Lana Edge",
            id: "cnTobUDy6",
            cars: [
                {
                    name: "F250",
                    year: 2020,
                    price: 198500,
                    carNumber: "Xxcy_",
                    ownerId: "cnTobUDy6",
                },
                {
                    name: "Hilux",
                    year: 2005,
                    price: 35005,
                    carNumber: "VSCUj",
                    ownerId: "cnTobUDy6",
                },
            ],
            cash: 7000,
        },
        {
            name: "Nikita Philip",
            id: "5x2tMcX4R",
            cars: [
                {
                    name: "Impala",
                    year: 2016,
                    price: 65042,
                    carNumber: "LKInp",
                    ownerId: "5x2tMcX4R",
                },
            ],
            cash: 40541,
        },
        {
            name: "Bob Steel",
            id: "Wm6BkA1F0",
            cars: [],
            cash: 15732,
        },
        {
            name: "Will Reyes",
            id: "FQvNsEwLZ",
            cars: [
                { name: "X6", year: 2020, price: 966500, ownerId: "FQvNsEwLZ" },
                {
                    name: "Land Cruiser",
                    year: 2020,
                    price: 336300,
                    carNumber: "vaJvd",
                    ownerId: "FQvNsEwLZ",
                },
                {
                    name: "Romeo Julia",
                    year: 2020,
                    price: 275406,
                    carNumber: "qLoYR",
                    ownerId: "FQvNsEwLZ",
                },
                {
                    name: "Explorer",
                    year: 2020,
                    price: 265200,
                    carNumber: "tlGRq",
                    ownerId: "FQvNsEwLZ",
                },
            ],
            cash: 1547242,
        },
    ],
    taxesAuthority: {
        totalTaxesPaid: 0,
        sumOfAllTransactions: 0,
        numberOfTransactions: 0,
    },
    
    /// Agency Operations: ///
    
    //1-Search for a car agency by its name or ID.
    carAgencySearch(nameOrID) {
        const carAgency = this.sellers.find((agency) => //Use the 'find' method to search for an agency
        nameOrID === agency.agencyName || nameOrID === agency.agencyId);
        if (carAgency) { //Check if an agency was found
            return carAgency; // Return the agency object if found
        } else { // Return an error message if no agency is found
            return "Sorry, Car agency is not found by this name/id: " + nameOrID;
        }
    },
    
    //2-Retrieve all agencies' names.
    AllAgenciesNames () {
    const agenciesNames = this.sellers.map((agency) => agency.agencyName); //uses the map method to create an array of agency names by iterating through the agencies and extracting their agencyName property.
    return agenciesNames; // returns an array of agency names.
    },
   
    //3-Add a new car to an agency's inventory.
 AddCarToAgency (agencyName, car) {
    const agency = this.carAgencySearch(agencyName); //First, search for the agency using the carAgencySearch function.
    if (agency) { //If the agency exists, it checks if a car with the same brand and model.name already exists in the agency's inventory.
        const foundCar = agency.cars.find ((c) =>
            c.brand === car.brand && c.models.some((model) => car.model.name));        
        if (foundCar) { //If a matching car is found, the new model is added to the existing car's models array.
            foundCar.models.push({
                name: car.model.name,
                year: car.model.year,
            carNumber: car.model.carNumber,
            ownerId: agency.agencyId, 
            });
        }else { // If no matching car is found, a new car entry is created in the agency's inventory.
            agency.cars.push({
                brand: car.brand,
                models: [
                    {
                        name: car.model.name,
                        year: car.model.year,
                    carNumber: car.model.carNumber,
                    ownerId: agency.agencyId, 
                    },
                ],
            });
        }
        return "The Car is Added successfully.";
    }
    return "Sorry, Can't Add a new car.";
},

//4- Removing car from agency:


//5- update the agency credit:
updateAgencyCredit (agencyName, amount) {
    const agency = this.carAgencySearch(agencyName); //searching for the agency using the carAgencySearch
    if (agency) { // If the agency exist
        agency.credit += amount; //updates the agency's cash balance by adding or subtracting the specified amount.
        return "Cash balance is updated.";
    }
    return "Cash balanced isn't update.";
},

// 6- update car price:
updateCarPrice (agencyName, carNumber, newPrice) {
    const agency = this.carAgencySearch(agencyName);//searching for the agency using the carAgencySearch
    if (agency) { // If the agency exist
        for (const car of agency.cars) { //iterating through the agency's inventory to find the car with the matching carNumber.
            const model = car.models.find((model) => model.carNumber === carNumber);
            if (model) { // If the car is found,
                model.price = newPrice; // its price is updated to the new price.
                return "The car's price is updated successfully.";
            }
        }
    }
    return "The car price is'nt update";
},

// 7- get total agency revenue:
getTotalAgencyRevenue (agencyName) {
const agency = this.carAgencySearch(agencyName);
if (agency) {
    let totalRevenue = 0;
    for (const car of agency.cars) { //iterating through the agency's inventory
        for (const model of car.models) { // and also iterating through the cars models.
            totalRevenue += model.price; // summing up the prices of all cars.
        }
    }
    return totalRevenue; //returns the total revenue as a number.
}
return 0; // if the agency didn't found return 0.
},

//8- transfer car between agencies:


/// Customer Operations:

//1- search customer by name or id:
searchCustomerByNameOrId (nameOrID) {
    const customer = this.customers.find(( customer) =>
    customer.name === nameOrID || customer.id === nameOrID);
    if (customer) {
        return true;
    } else {
        return "Sorry, cant found customer with this name/id !"
    }
},

//2- get all customers names
getAllCustomerNames () {
    const allCustomerNames = this.customers.map((customer) => customer.name);
    return allCustomerNames;
},

//3- update customer cash:
updateCustomerCash (customerId, amount) {
const customer = this.customers.find((c) => c.id === customerId);
if (customer) {
    customer.cash +=amount;
    return true;
}
return false;
},

// 4- get customer total car value:
getCustomerTotalCarValue (customerId) {
    const customer = this.customers.find((c) => c.id === customerId);
    if (customer) {
        let totalValue = 0;
        for (const car of customer.cars) {
            totalValue =+ car.price;
        } 
        return totalValue;
    }
    return 0;
},

/// Car Operations ///

//1- get all available cars:
getAllAvailableCars () {
    const allCars = [];
for (const agency of this.sellers) {
    for (const car of agency.cars) {
        allCars.push(...car.models);
    }
}
return allCars;
},

//2- search cars:


//3- get most expensive car


//4- get most cheap car


/// Car Purchase Operations ///


};


 
